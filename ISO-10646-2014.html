<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style>
body
{
  font-family: arial, sans-serif;
  max-width: 6.75in;
  margin: 0px auto;
  font-size: 85%;
}
 ins  {background-color: #CCFFCC; text-decoration: none;}
 del  {background-color: #FFCACA; text-decoration: none;}
 pre  {background-color: #D7EEFF; font-size: 95%; font-family: "courier new", courier, serif;}
 code {font-family: "courier new", courier, serif;}
 table {font-size: 90%;}
</style>
<title>ISO 10646:2014</title>
</head>

<body>
<table>
<tr>
  <td align="left">Doc. no.:</td>
  <td align="left"><span style="background-color: #FFFF00">D0417R1</span></td>
</tr>
<tr>
  <td align="left">Date:</td>
  <td align="left">
  <!--webbot bot="Timestamp" S-Type="EDITED" S-Format="%Y-%m-%d" startspan -->2016-11-03<!--webbot bot="Timestamp" endspan i-checksum="12108" --></td>
</tr>
<tr>
  <td align="left">Reply to:</td>
  <td align="left">Beman Dawes &lt;bdawes at acm dot org&gt;
</tr>
<tr>
  <td align="left">Audience:</td>
  <td align="left">Core, Library</td>
</tr>
</table>

<h1>C++17 should refer to ISO/IEC 10646 2014 instead of 1994 (R1)</h1>

<p>ISO standards are only supposed to have normative references to the 
latest version of other ISO standards, yet the C++17 CD still refers to <i>ISO/IEC 10646-1:1993, Information 
technology — Universal Multiple-Octet Coded Character Set (UCS)— Part 1: 
Architecture and Basic Multilingual Plane</i>.</p>

<p>There have been three revisions and numerous amendments of 10646 since 1994. 
The changes that impact the C++17 CD include:</p>

<ul>
  <li>The name has changed to <i>Information technology — Universal Coded 
  Character Set (UCS)</i>.</li>
  <li>UTF-8, UTF-16, and UTF-32 are now defined. They were not even a part of 
  10646:1994 before amendments, so the C++ standard has been using the terms 
  without a normative definition.</li>
  <li>UCS-2 has been deprecated, and has been replaced by UTF-16. This is a 
  normative change for the C++ standard because UCS-2 and UTF-16 are not the 
  same. The differences are disjoint, however, so the change breaks no existing 
  code.</li>
  <li>The term UCS-4 has been changed to UTF-32. Although 10646 says &quot;The terms 
  UTF-32 and UCS-4 can be used interchangeably...&quot;, the C++ standard should use 
  the preferred term UTF-32 throughout.</li>
</ul>

<p>See 
<a href="http://standards.iso.org/ittf/PubliclyAvailableStandards/index.html">http://standards.iso.org/ittf/PubliclyAvailableStandards/index.html</a> 
for a copy of ISO/IEC 10646:2014.</p>

<h2>Discussion of the UCS2 to UTF-16 change</h2>

<p>The term &#39;UCS2&#39; is only used twice, in the specification of the C++11 header 
&lt;codecvt&gt; facets in [locale.stdcvt].</p>

<p>Code using these facets which tried to convert to or from UTF-16 <code>
externT</code> strings was previously broken for surrogate pairs, but with the 
change will now work correctly. Code converting to or from UCS2 <code>externT</code> 
strings continues work as in the past because it contains no surrogates. (The 
ranges for high surrogates, low surrogates, and valid BMP characters are 
disjoint.)</p>

<h2>Revision history</h2>

<p><b>R1 - 2016 Post-Issaquah mailing</b></p>

<ul>
  <li>Add Acknowledgements.</li>
  <li>Add &quot;... hereinafter called UCS&quot; paragraph.</li>
  <li>Remove proposed changes to Annex E. Clark Nelson points out that the 
  omission of F0000-FFFFD and 100000-10FFFD is deliberate because they are 
  reserved for private use.</li>
</ul>

<p><b>R0 - 2016 Post-Oulu mailing</b></p>

<h2>Acknowledgements</h2>

<p>Thanks to Richard Smith for encouraging me to write this paper.</p>

<p>Thanks to Tom Honermann for standardese discussions that led me to 
realize how out-of-date the ISO/IEC 10646:1-1993 reference was.</p>

<h2>Proposed changes</h2>

<p><i>Strike the wording <del>high-lighted in red</del> and add the wording <ins>high-lighted in 
green</ins>.</i></p>

<h4>1.2 Normative references [intro.refs]</h4>

<p>— ISO/IEC 10646<del>-1:1993, <i>Information technology — Universal 
Multiple-Octet Coded Character Set (UCS)</i> — Part 1: Architecture and Basic 
Multilingual Plane</del> <ins>:2014, <i>Information technology — Universal Coded 
Character Set (UCS)</i></ins></p>

<p><i>Add a new paragraph at the end of [intro.refs]:</i></p>

<blockquote>

<p><ins>The Universal Coded Character Set described in ISO/IEC 10646:2014 is 
hereinafter called <i>UCS</i>.</ins></p>

</blockquote>

<h4>22.5 Standard code conversion facets [locale.stdcvt]</h4>

<p>For the facet <code>codecvt_utf8</code>:</p>

<blockquote>

<p>— The facet shall convert between UTF-8 multibyte sequences and 
<del>UCS2</del> <ins>UTF-16</ins> or <del>UCS4</del> <ins>UTF-32</ins> (depending on the size
of Elem) within the program.</p>

</blockquote>

<p>...</p>

<p>For the facet <code>codecvt_utf16:</code></p>

<blockquote>

<p>— The facet shall convert between UTF-16 multibyte sequences and 
<del>UCS2</del> <ins>UTF-16</ins> or <del>UCS4</del> <ins>UTF-32</ins> 
(depending on the size of Elem) within the program.</p>

</blockquote>

<hr>

<p><br>
&nbsp;</p>

</body>

</html>